<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>What is Terra &mdash; Terra 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Terra Settings" href="settings.html" />
    <link rel="prev" title="Welcome to Terra’s documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Terra
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">What is Terra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#settings">Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#templating">Templating</a></li>
<li class="toctree-l4"><a class="reference internal" href="#path-translation">Path translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-usage">Advanced usage</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Terra Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html#executor-settings">Executor Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html#compute-settings">Compute Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html#workflow-settings">Workflow Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html#logging-settings">Logging Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="apps.html">Terra Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute.html">Compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/modules.html">terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing Guidlines</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Terra</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">What is Terra</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/terra/getting_started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="what-is-terra">
<h1>What is Terra<a class="headerlink" href="#what-is-terra" title="Permalink to this heading"></a></h1>
<p>Terra in an infrastructure with the purpose of running algorithms in a compute architecture agnostic way. The goal is, once an algorithm (app) is setup, the same algorithm can be deployed on multiple compute arches</p>
<section id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h2>
<section id="settings">
<h3>Settings<a class="headerlink" href="#settings" title="Permalink to this heading"></a></h3>
<p>Everything in a terra app should be controlled by one main json file. This file will contain all the information from what compute arch to use, any compute arch settings, logging settings, input files, output, etc… Accessing the settings will be accomplished simply by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">terra</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="n">settings</span><span class="o">.</span><span class="n">my_settings</span>
<span class="n">settings</span><span class="o">.</span><span class="n">something</span><span class="o">.</span><span class="k">else</span><span class="o">.</span><span class="n">here</span>
</pre></div>
</div>
<p>The settings file used is controlled by the environment variable <span class="target" id="index-0"></span><a class="reference internal" href="../python/terra.core.html#envvar-TERRA_SETTINGS_FILE"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TERRA_SETTINGS_FILE</span></code></a> and is usually set by the cli.</p>
<p>While, underneath the hood the settings is a nested dictionary, it will be accessed via attributes instead of indexing, for ease of use.</p>
<section id="templating">
<h4>Templating<a class="headerlink" href="#templating" title="Permalink to this heading"></a></h4>
<p>Default values of settings are prepopulated by <a class="reference internal" href="../python/terra.core.html#terra.core.settings.global_templates" title="terra.core.settings.global_templates"><code class="xref py py-data docutils literal notranslate"><span class="pre">terra.core.settings.global_templates</span></code></a>. This data structure is a list of tuple pair of <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>. Within the pair, the first <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> represents a <em>pattern</em>, and the second is the <em>default</em> values. When values of <em>pattern</em> match the configuration, then the <em>defaults</em> of that pattern are applied. These <em>defaults</em> are applied in order, where the last <em>default</em> overrides the earlier ones, but by combining all of the dictionaries into one, using <a class="reference external" href="https://visionsystemsinc.github.io/vsi_common/python/vsi.tools.html#vsi.tools.python.nested_update" title="(in VSI Common)"><code class="xref py py-func docutils literal notranslate"><span class="pre">vsi.tools.python.nested_update()</span></code></a></p>
</section>
<section id="path-translation">
<span id="settings-path-translation"></span><h4>Path translation<a class="headerlink" href="#path-translation" title="Permalink to this heading"></a></h4>
<p>Because services and tasks can run in different containers or even on different computers, terra settings has a “path translation” feature built in. If any setting’s name ends in <code class="docutils literal notranslate"><span class="pre">_dir</span></code>/<code class="docutils literal notranslate"><span class="pre">_dirs</span></code>/<code class="docutils literal notranslate"><span class="pre">_file</span></code>/<code class="docutils literal notranslate"><span class="pre">_files</span></code>/<code class="docutils literal notranslate"><span class="pre">_path</span></code>/<code class="docutils literal notranslate"><span class="pre">paths</span></code>, then terra will automatically convert the path between the host and container, e.g. <code class="docutils literal notranslate"><span class="pre">settings.foo.bar_path</span></code>. This is done by inspecting the compute’s configuration and creating a mount map. If <code class="docutils literal notranslate"><span class="pre">/opt/test/foo</span></code> is mounted to <code class="docutils literal notranslate"><span class="pre">/data</span></code> in a container and if <code class="docutils literal notranslate"><span class="pre">bar_path</span></code> is set to <code class="docutils literal notranslate"><span class="pre">/opt/test/foo/bar/file.txt</span></code>, then in the container it will have the value <code class="docutils literal notranslate"><span class="pre">/data/bar/file.txt</span></code>. For computes that utilize the environment variables <code class="docutils literal notranslate"><span class="pre">TERRA_*_VOLUMES</span></code>, these will be included in the volume mapping.</p>
<p>For tasks, keyword arguments are also translated if their names end with the same suffixes. This includes the keyword arguments themselves, and any nested combination of list/tuple/dict that has a dict key value ending with the same suffixes.</p>
<p>If the return value of a task is also a nested list/tuple/dict, those keys ending with the same suffixes are also translated back.</p>
<p>When a compute/executor has the potential to change paths, a <code class="docutils literal notranslate"><span class="pre">configuration_map_service</span></code>/<code class="docutils literal notranslate"><span class="pre">configuration_map</span></code> method is needed to return this list of tuple pairs (host, container) of mounts.</p>
</section>
<section id="advanced-usage">
<h4>Advanced usage<a class="headerlink" href="#advanced-usage" title="Permalink to this heading"></a></h4>
<p>Todo</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to Terra’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="settings.html" class="btn btn-neutral float-right" title="Terra Settings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, VSI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>