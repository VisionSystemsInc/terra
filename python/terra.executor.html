<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>terra.executor package &mdash; Terra 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="terra.executor.celery package" href="terra.executor.celery.html" />
    <link rel="prev" title="terra.core package" href="terra.core.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Terra
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../terra/getting_started.html">What is Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/settings.html">Terra Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/settings.html#executor-settings">Executor Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/settings.html#compute-settings">Compute Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/settings.html#workflow-settings">Workflow Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/settings.html#logging-settings">Logging Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/apps.html">Terra Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/compute.html">Compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terra/executor.html">Executor</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">terra</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="terra.html">terra package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="terra.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="terra.compute.html">terra.compute package</a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.core.html">terra.core package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">terra.executor package</a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.generic.html">terra.generic package</a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.utils.html">terra.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="terra.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="terra.html#module-terra.logger">terra.logger module</a></li>
<li class="toctree-l3"><a class="reference internal" href="terra.html#module-terra.task">terra.task module</a></li>
<li class="toctree-l3"><a class="reference internal" href="terra.html#module-terra.workflow">terra.workflow module</a></li>
<li class="toctree-l3"><a class="reference internal" href="terra.html#module-terra">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../terra/contributing.html">Contributing Guidlines</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Terra</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">terra</a></li>
          <li class="breadcrumb-item"><a href="terra.html">terra package</a></li>
      <li class="breadcrumb-item active">terra.executor package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python/terra.executor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="terra-executor-package">
<h1>terra.executor package<a class="headerlink" href="#terra-executor-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="terra.executor.celery.html">terra.executor.celery package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="terra.executor.celery.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="terra.executor.celery.html#module-terra.executor.celery.celeryconfig">terra.executor.celery.celeryconfig module</a></li>
<li class="toctree-l2"><a class="reference internal" href="terra.executor.celery.html#module-terra.executor.celery.executor">terra.executor.celery.executor module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor.configuration_map"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.configuration_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor.configure_logger"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.configure_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor.multiprocess"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.multiprocess</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor.reconfigure_logger"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.reconfigure_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor.shutdown"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.shutdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutor.submit"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.submit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutorFuture"><code class="docutils literal notranslate"><span class="pre">CeleryExecutorFuture</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.executor.CeleryExecutorFuture.cancel"><code class="docutils literal notranslate"><span class="pre">CeleryExecutorFuture.cancel()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="terra.executor.celery.html#module-terra.executor.celery">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor.configuration_map"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.configuration_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor.configure_logger"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.configure_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor.multiprocess"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.multiprocess</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor.reconfigure_logger"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.reconfigure_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor.shutdown"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.shutdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="terra.executor.celery.html#terra.executor.celery.CeleryExecutor.submit"><code class="docutils literal notranslate"><span class="pre">CeleryExecutor.submit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-terra.executor.base">
<span id="terra-executor-base-module"></span><h2>terra.executor.base module<a class="headerlink" href="#module-terra.executor.base" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.base.BaseExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.base.</span></span><span class="sig-name descname"><span class="pre">BaseExecutor</span></span><a class="headerlink" href="#terra.executor.base.BaseExecutor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Executor</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.base.BaseExecutor.configure_logger">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">configure_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sender</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.base.BaseExecutor.configure_logger" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.base.BaseExecutor.multiprocess">
<span class="sig-name descname"><span class="pre">multiprocess</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#terra.executor.base.BaseExecutor.multiprocess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.base.BaseExecutor.reconfigure_logger">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reconfigure_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sender</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.base.BaseExecutor.reconfigure_logger" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.base.BaseFuture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.base.</span></span><span class="sig-name descname"><span class="pre">BaseFuture</span></span><a class="headerlink" href="#terra.executor.base.BaseFuture" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></p>
</dd></dl>

</section>
<section id="module-terra.executor.dummy">
<span id="terra-executor-dummy-module"></span><h2>terra.executor.dummy module<a class="headerlink" href="#module-terra.executor.dummy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.dummy.DummyExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.dummy.</span></span><span class="sig-name descname"><span class="pre">DummyExecutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.dummy.DummyExecutor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#terra.executor.base.BaseExecutor" title="terra.executor.base.BaseExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseExecutor</span></code></a></p>
<p>Executor that does nothing, just logs what would happen.</p>
<p>Note: Don’t base new executors off of this example</p>
<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.dummy.DummyExecutor.shutdown">
<span class="sig-name descname"><span class="pre">shutdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.dummy.DummyExecutor.shutdown" title="Permalink to this definition"></a></dt>
<dd><p>Clean-up the resources associated with the Executor.</p>
<p>It is safe to call this method several times. Otherwise, no other
methods can be called after this one.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>wait: If True then shutdown will not return until all running</dt><dd><p>futures have finished executing and the resources used by the
executor have been reclaimed.</p>
</dd>
<dt>cancel_futures: If True then shutdown will cancel all pending</dt><dd><p>futures. Futures that are completed or running will not be
cancelled.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.dummy.DummyExecutor.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.dummy.DummyExecutor.submit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-terra.executor.process">
<span id="terra-executor-process-module"></span><h2>terra.executor.process module<a class="headerlink" href="#module-terra.executor.process" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.process.ProcessPoolExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.process.</span></span><span class="sig-name descname"><span class="pre">ProcessPoolExecutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.process.ProcessPoolExecutor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessPoolExecutor</span></code>, <a class="reference internal" href="#terra.executor.base.BaseExecutor" title="terra.executor.base.BaseExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseExecutor</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.process.ProcessPoolExecutor.multiprocess">
<span class="sig-name descname"><span class="pre">multiprocess</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#terra.executor.process.ProcessPoolExecutor.multiprocess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-terra.executor.resources">
<span id="terra-executor-resources-module"></span><h2>terra.executor.resources module<a class="headerlink" href="#module-terra.executor.resources" title="Permalink to this heading"></a></h2>
<p>In a multithreaded or multiprocessing environment, it may become necessary to
divide up and balance a limited “resource” among multiple workers. For example,
if you have 4 GPUs and each GPU can only handle two workers at a time, you
would have a total of 8 workers. However, while running a
<a class="reference internal" href="terra.html#terra.task.TerraTask" title="terra.task.TerraTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">terra.task.TerraTask</span></code></a> each worker would need to know what resource id
(i.e. which specific GPU) to use. A <a class="reference internal" href="#terra.executor.resources.Resource" title="terra.executor.resources.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a> handles and balances this
for you in an easy-to-manage way.</p>
<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.resources.ProcessLocalStorage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">ProcessLocalStorage</span></span><a class="headerlink" href="#terra.executor.resources.ProcessLocalStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Processor local storage class</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.resources.ProcessLocalStorage.instance_id">
<span class="sig-name descname"><span class="pre">instance_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#terra.executor.resources.ProcessLocalStorage.instance_id" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.resources.ProcessLocalStorage.lock">
<span class="sig-name descname"><span class="pre">lock</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#terra.executor.resources.ProcessLocalStorage.lock" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.resources.ProcessLocalStorage.resource_id">
<span class="sig-name descname"><span class="pre">resource_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#terra.executor.resources.ProcessLocalStorage.resource_id" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.resources.Resource">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">Resource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_softfilelock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.Resource" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A <a class="reference internal" href="#terra.executor.resources.Resource" title="terra.executor.resources.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a> instance represents a set of resources that can be
shared between multiple threads or processes on a single computer.</p>
<p>This class will allocate a resource for a task to use by simply calling
<a class="reference internal" href="#terra.executor.resources.Resource.acquire" title="terra.executor.resources.Resource.acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">acquire()</span></code></a> or using a <a class="reference external" href="https://docs.python.org/3.9/reference/compound_stmts.html#with" title="(in Python v3.9)"><span class="xref std std-ref">with</span></a> context manager.
Multiple calls to <a class="reference internal" href="#terra.executor.resources.Resource.acquire" title="terra.executor.resources.Resource.acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">acquire()</span></code></a> or using nested <a class="reference external" href="https://docs.python.org/3.9/reference/compound_stmts.html#with" title="(in Python v3.9)"><span class="xref std std-ref">with</span></a>-s
are ok, as it will simply use the same resource every time. For each call to
<a class="reference internal" href="#terra.executor.resources.Resource.acquire" title="terra.executor.resources.Resource.acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">acquire()</span></code></a>, an equal number of calls to <a class="reference internal" href="#terra.executor.resources.Resource.release" title="terra.executor.resources.Resource.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a> are required.
For this reason, using <a class="reference external" href="https://docs.python.org/3.9/reference/compound_stmts.html#with" title="(in Python v3.9)"><span class="xref std std-ref">with</span></a> context managers are often
the easier way to go.</p>
<p>There should not be more workers than resources available for a specific
queue of workers. Because there are enough resources for every worker, the
resource can be considered reserved for the lifetime of the task—there
is no need to release early after a function call or a small section of the
task because no one is waiting for resources.</p>
<p>Resources need to be registered via the <a class="reference internal" href="#terra.executor.resources.ResourceManager" title="terra.executor.resources.ResourceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceManager</span></code></a> prior to
creating worker threads/processes, so that they are configured correctly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_name</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A unique name of resource. Must not contain symbols incompatible with the
filesystem</p></li>
<li><p><strong>resources</strong> (int or <a class="reference external" href="https://docs.python.org/3.9/glossary.html#term-iterable" title="(in Python v3.9)"><span class="xref std std-term">iterable</span></a>) – A sequence of items to represent the different resources. An integer is
shorthand for <code class="docutils literal notranslate"><span class="pre">range(0,</span> <span class="pre">items_integer)</span></code>. If objects are used for
resources, they need to be pickleable, or else multiprocessing will fail.</p></li>
<li><p><strong>repeat</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – The number of workers you want to be able to acquire a resource, e.g.,
two simultaneous workers per resource.</p></li>
<li><p><strong>use_softfilelock</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><em>None</em>) – If an OS does not support hard locks, <a class="reference external" href="https://py-filelock.readthedocs.io/en/latest/api.html#filelock.SoftFileLock" title="(in Project name not set v3.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">filelock.SoftFileLock</span></code></a> will
be used automatically. However, even if the OS supports hard locks, some
filesystems (especially network file systems) may not support successful
hard locking. In these cases, hardlock support needs to be tested on a
per directory basis. By default, <code class="docutils literal notranslate"><span class="pre">use_softfilelock</span></code> is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>,
which will run <a class="reference internal" href="#terra.executor.resources.test_dir" title="terra.executor.resources.test_dir"><code class="xref py py-func docutils literal notranslate"><span class="pre">test_dir()</span></code></a> to determine if the directory can handle
hard locking, and update <code class="docutils literal notranslate"><span class="pre">self._use_softfilelock</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> or
<code class="docutils literal notranslate"><span class="pre">False</span></code>. Setting <code class="docutils literal notranslate"><span class="pre">use_softfilelock</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> will
bypass testing, and always use the supplied value.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is based on using lock files to lock resources. Why use lock
files? Hard-lock files are one of the few methods that are tolerant to
unlocking after a seg fault. Given that both windows and linux support hard
file locking, it is easy to use and makes more sense to use lock files than
other forms of IPC to track resources and handle seg faults. Soft file
locking is also supported, but less preferred.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class supports <a class="reference internal" href="../terra/executor.html#executor"><span class="std std-ref">Executor</span></a>-s that use threading or multiprocessing
to spawn workers. There is no additional effort needed to maintain this
worker isolation. However, if a single task in a threaded executor worker
were to spawn additional threads (a new process has a new thread too) during
a task’s execution, then <a class="reference internal" href="#terra.executor.resources.Resource" title="terra.executor.resources.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a> would have no way of knowing that
the new threads were part of the same worker. The same is true if a single
task in a multiprocess executor worker were to spawn additional processes. If
this were to ever occur, be sure to acquire the resource before spawning to
get the intended result.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.FileLock">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FileLock</span></span><a class="headerlink" href="#terra.executor.resources.Resource.FileLock" title="Permalink to this definition"></a></dt>
<dd><p>The class of <a class="reference external" href="https://py-filelock.readthedocs.io/en/latest/api.html#filelock.FileLock" title="(in Project name not set v3.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">filelock.FileLock</span></code></a> used for locks in
<a class="reference internal" href="#terra.executor.resources.Resource.lock_dir" title="terra.executor.resources.Resource.lock_dir"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Resource.lock_dir</span></code></a>.</p>
<p>Hard locking is better, but only works if the OS and Filesystem supports
it. Sometimes it is necessary to use soft locking, so this property will
always return the correct class to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/glossary.html#term-class" title="(in Python v3.9)"><span class="xref std std-term">class</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.acquire">
<span class="sig-name descname"><span class="pre">acquire</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.Resource.acquire" title="Permalink to this definition"></a></dt>
<dd><p>Acquires and locks a resource. Multiple calls will return the same resource
and increase the lock counter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns the resource that is allocated to this worker</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#terra.executor.resources.ResourceError" title="terra.executor.resources.ResourceError"><strong>ResourceError</strong></a> – There are no more resources available. This should not happen if the
    total number of resources and workers are equal.
    
    If a thread/process worker spawns additional threads/processes, then
    the resource needs to be acquired by the actual worker (in celery, this
    is called the “worker child”, not to be confused with the “worker”
    parent, which is more of a manager process and thus does not need a
    resource) and then passed along to the other threads without using this
    class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.is_locked">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_locked</span></span><a class="headerlink" href="#terra.executor.resources.Resource.is_locked" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.lock_counter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lock_counter</span></span><a class="headerlink" href="#terra.executor.resources.Resource.lock_counter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.lock_dir">
<span class="sig-name descname"><span class="pre">lock_dir</span></span><a class="headerlink" href="#terra.executor.resources.Resource.lock_dir" title="Permalink to this definition"></a></dt>
<dd><p>The directory where the lock files will be stored.</p>
<p>By default, uses the <code class="docutils literal notranslate"><span class="pre">settings.settings_dir</span></code> to store the lock files. A
specific lock dir represents a specific resource, and contains the pid of
the parent process so that spawned processes will be able to communicate
about the same resource. Also contains the hostname so that multiple host
workers will not collide when using a common network based filesystem.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.lock_file_name">
<span class="sig-name descname"><span class="pre">lock_file_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.Resource.lock_file_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.resources.Resource.release">
<span class="sig-name descname"><span class="pre">release</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.Resource.release" title="Permalink to this definition"></a></dt>
<dd><p>Releases a resource and unlocks the associated lock file.</p>
<p>If the resource has been locked multiple times, calling <a class="reference internal" href="#terra.executor.resources.Resource.release" title="terra.executor.resources.Resource.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a>
decrements the counter, and only releases when the counter reaches zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>force</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If true, the lock counter is ignored and the lock is released in every
case.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – Raised if the resource is not currently locked</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="terra.executor.resources.ResourceError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">ResourceError</span></span><a class="headerlink" href="#terra.executor.resources.ResourceError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#Exception" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Exception thrown when no more resources are available</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.resources.ResourceManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">ResourceManager</span></span><a class="headerlink" href="#terra.executor.resources.ResourceManager" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A singleton class that provides global scope access to <a class="reference internal" href="#terra.executor.resources.Resource" title="terra.executor.resources.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a>-s</p>
<p>Resources need to be registered before worker threads or processes are
created or else they will not inherit the correct resource settings.</p>
<p class="rubric">Example</p>
<p>ResourceManager.register_resource(“gpu”, 2, 4)</p>
<dl class="simple">
<dt>def run():</dt><dd><dl class="simple">
<dt>with ResourceManager.get_resource(“gpu”) as gpu:</dt><dd><p>print(f”I’m using gpu {gpu}”)</p>
</dd>
</dl>
</dd>
<dt>with ProcessPoolExecutor(max_workers=8) as executor:</dt><dd><p>executor.submit(run)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.resources.ResourceManager.get_resource">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_resource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.ResourceManager.get_resource" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.resources.ResourceManager.register_resource">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">register_resource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.ResourceManager.register_resource" title="Permalink to this definition"></a></dt>
<dd><p>Registers a new resource</p>
<p>Resources should be registered in: <code class="docutils literal notranslate"><span class="pre">{app}/tasks/__init__.py</span></code>. This works
out because tasks are loaded after settings and logging are loaded, but
before the Executor spawns workers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A unique name for the resource. Must not contain symbols
incompatible with the filesystem. Simple alphanumerics suggested.</p></li>
<li><p><strong>*args</strong> – Additional args passed to <a class="reference internal" href="#terra.executor.resources.Resource" title="terra.executor.resources.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a> init</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword args passed to <a class="reference internal" href="#terra.executor.resources.Resource" title="terra.executor.resources.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a> init</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If a resource with that name already exists</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="terra.executor.resources.ResourceManager.resources">
<span class="sig-name descname"><span class="pre">resources</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#terra.executor.resources.ResourceManager.resources" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.resources.ThreadLocalStorage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">ThreadLocalStorage</span></span><a class="headerlink" href="#terra.executor.resources.ThreadLocalStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#terra.executor.resources.ProcessLocalStorage" title="terra.executor.resources.ProcessLocalStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessLocalStorage</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">_local</span></code></p>
<p>Thread version of <a class="reference internal" href="#terra.executor.resources.ProcessLocalStorage" title="terra.executor.resources.ProcessLocalStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessLocalStorage</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="terra.executor.resources.atexit_resource_release">
<span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">atexit_resource_release</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.atexit_resource_release" title="Permalink to this definition"></a></dt>
<dd><p>Clean up all resources before python starts unloading <a class="reference external" href="https://docs.python.org/3.9/library/os.html#module-os" title="(in Python v3.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> because
then it’s too late.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="terra.executor.resources.test_dir">
<span class="sig-prename descclassname"><span class="pre">terra.executor.resources.</span></span><span class="sig-name descname"><span class="pre">test_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.resources.test_dir" title="Permalink to this definition"></a></dt>
<dd><p>Test if a directory will support hard file locking.</p>
<p>If the directory cannot support hard file locking, then the
<code class="docutils literal notranslate"><span class="pre">use_softfilelock</span></code> needs to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

</section>
<section id="module-terra.executor.sync">
<span id="terra-executor-sync-module"></span><h2>terra.executor.sync module<a class="headerlink" href="#module-terra.executor.sync" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.sync.SyncExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.sync.</span></span><span class="sig-name descname"><span class="pre">SyncExecutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.sync.SyncExecutor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#terra.executor.base.BaseExecutor" title="terra.executor.base.BaseExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseExecutor</span></code></a></p>
<p>Executor that does the job synchronously.</p>
<p>All the returned Futures will be already resolved. This executor is intended
to be mainly used on tests or to keep internal API conformance with the
Executor interface.</p>
<p>Based on a snippet from <a class="reference external" href="https://stackoverflow.com/a/10436851/798575">https://stackoverflow.com/a/10436851/798575</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.sync.SyncExecutor.shutdown">
<span class="sig-name descname"><span class="pre">shutdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.sync.SyncExecutor.shutdown" title="Permalink to this definition"></a></dt>
<dd><p>Clean-up the resources associated with the Executor.</p>
<p>It is safe to call this method several times. Otherwise, no other
methods can be called after this one.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>wait: If True then shutdown will not return until all running</dt><dd><p>futures have finished executing and the resources used by the
executor have been reclaimed.</p>
</dd>
<dt>cancel_futures: If True then shutdown will cancel all pending</dt><dd><p>futures. Futures that are completed or running will not be
cancelled.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.sync.SyncExecutor.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.sync.SyncExecutor.submit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-terra.executor.thread">
<span id="terra-executor-thread-module"></span><h2>terra.executor.thread module<a class="headerlink" href="#module-terra.executor.thread" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.thread.ThreadPoolExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.thread.</span></span><span class="sig-name descname"><span class="pre">ThreadPoolExecutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.thread.ThreadPoolExecutor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadPoolExecutor</span></code>, <a class="reference internal" href="#terra.executor.base.BaseExecutor" title="terra.executor.base.BaseExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseExecutor</span></code></a></p>
<p>Terra version of <a class="reference external" href="https://docs.python.org/3.9/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.ThreadPoolExecutor</span></code></a></p>
<p>Unlike other executors, <a class="reference internal" href="#terra.executor.thread.ThreadPoolExecutor" title="terra.executor.thread.ThreadPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadPoolExecutor</span></code></a> has no process isolation.
This results in a scenario where multiple threads could use terra settings to
influence each other, which is not typical behavior, given that all other
executors have process isolation and do not allow this.</p>
<p><a class="reference internal" href="#terra.executor.thread.ThreadPoolExecutor" title="terra.executor.thread.ThreadPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadPoolExecutor</span></code></a> will downcast <a class="reference internal" href="terra.core.html#module-terra.core.settings" title="terra.core.settings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">terra.core.settings</span></code></a> to a
thread-safe <a class="reference internal" href="terra.core.html#terra.core.settings.LazySettingsThreaded" title="terra.core.settings.LazySettingsThreaded"><code class="xref py py-class docutils literal notranslate"><span class="pre">terra.core.settings.LazySettingsThreaded</span></code></a> where each
Executor thread has it’s own thread local storage version of the settings
structure.</p>
<p>This behavior is limited to threads started by <a class="reference internal" href="#terra.executor.thread.ThreadPoolExecutor" title="terra.executor.thread.ThreadPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadPoolExecutor</span></code></a>
only. All other threads will have normal thread behavior with the runner
threads, and use a single version of the settings. The only side effect is if
a task starts its own thread, it will be treated as one of the runner
threads, not a task thread. The currently known downside to this is log
messages will be reported as coming from the runner rather than task zone.
However, any attempts to edit settings from this rogue thread could
potentially have other unintended consequences.</p>
<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.thread.ThreadPoolExecutor.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.thread.ThreadPoolExecutor.submit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-terra.executor.utils">
<span id="terra-executor-utils-module"></span><h2>terra.executor.utils module<a class="headerlink" href="#module-terra.executor.utils" title="Permalink to this heading"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="terra.executor.utils.Executor">
<span class="sig-prename descclassname"><span class="pre">terra.executor.utils.</span></span><span class="sig-name descname"><span class="pre">Executor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;terra.executor.utils.ExecutorHandler</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#terra.executor.utils.Executor" title="Permalink to this definition"></a></dt>
<dd><p>The executor handler that all services will be interfacing
with when running parallel computation tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#terra.executor.utils.ExecutorHandler" title="terra.executor.utils.ExecutorHandler">ExecutorHandler</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="terra.executor.utils.ExecutorHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">terra.executor.utils.</span></span><span class="sig-name descname"><span class="pre">ExecutorHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">override_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.utils.ExecutorHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="terra.core.html#terra.core.utils.ClassHandler" title="terra.core.utils.ClassHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassHandler</span></code></a></p>
<p>The <a class="reference internal" href="#terra.executor.utils.ExecutorHandler" title="terra.executor.utils.ExecutorHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecutorHandler</span></code></a> class gives a single entrypoint to interact with
the <code class="docutils literal notranslate"><span class="pre">concurrent.futures</span></code> executor class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.utils.ExecutorHandler._connect_backend">
<span class="sig-name descname"><span class="pre">_connect_backend</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.utils.ExecutorHandler._connect_backend" title="Permalink to this definition"></a></dt>
<dd><p>Loads the executor backend’s base module, given either a fully qualified
compute backend name, or a partial (<code class="docutils literal notranslate"><span class="pre">terra.executor.{partial}.executor</span></code>),
and then returns a connection to the backend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self._override_type</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, override the name of the backend to load.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="terra.executor.utils.ExecutorHandler.configuration_map">
<span class="sig-name descname"><span class="pre">configuration_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#terra.executor.utils.ExecutorHandler.configuration_map" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-terra.executor">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-terra.executor" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="terra.core.html" class="btn btn-neutral float-left" title="terra.core package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="terra.executor.celery.html" class="btn btn-neutral float-right" title="terra.executor.celery package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, VSI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>